<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

    <title>Dashboard</title>
</head>
<body>
    {% if status == "failed" and message  %}
        <div id="dashboard-alert" class="alert alert-danger" role="alert">{{ message }}</div>
    {% elseif status == "success" and message %}
        <div id="dashboard-alert" class="alert alert-success" role="alert">{{ message }}</div>
    {% endif %}

    <form action="/index.php/dashboard" method="post">
        <input type="text" name="command" value="logout" hidden>
        <button type="submit">Log out</button>
    </form>

    <form action="/index.php/dashboard" method="post" enctype="multipart/form-data" style="margin: 40px 0px;">
        <input type="file" name="resume-upload[]" id="resume-upload" accept=".doc, .docx, .pdf" multiple>

        <button>Upload</button>
    </form>

    <div>
        <span>My Resumes</span>

        <form action="/index.php/dashboard" method="post">
            <input type="text" name="command" value="deleteAllResumes" hidden>
            <button type="submit">Clear</button>
        </form>

        {% if uploaded_resumes %}
            <ul>
                {% for filename in uploaded_resumes %}
                    <li>{{ filename }}</li>
                {% endfor %}
            </ul>
        {% else %}
            <p>n/a</p>
        {% endif %}
    </div>

    <div style="margin-top: 80px;">
        <span>Resume Finder</span>

        <form id="resume-finder" action="/index.php/filter" method="post" style="display: flex; flex-direction: column; width: 80%; max-width: 400px; margin-top: 10px; margin-bottom: 40px;">
            <button type="submit">Find</button>
        </form>

        <div>
            <span>Matches</span>

            <ul id="resume-finder-matches">
                <li>None</li>
            </ul>
        </div>
    </div>

    <script>
        const KEYWORDS = [];

        const FINDER = document.getElementById('resume-finder');

        FINDER.addEventListener('submit', function (event) {
            event.preventDefault();

            const REQUEST = new XMLHttpRequest();

            REQUEST.onload = function () {
                console.log(JSON.parse(this.responseText));
            };

            REQUEST.open('POST', FINDER.action);
            REQUEST.setRequestHeader('Content-Type', 'application/json;utf-8');
            REQUEST.send(JSON.stringify({keywords: KEYWORDS}));
        });
    </script>
</body>
</html>